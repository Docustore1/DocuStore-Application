<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store - Document Store</title>
    <link rel="stylesheet" href="style.css?v=7.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <!-- Export Libraries -->
    <script src="vendor/html2canvas.min.js"></script>
    <script src="vendor/jspdf.umd.min.js"></script>
    <script src="vendor/docx.js"></script>
    <script src="vendor/mammoth.browser.min.js"></script>
    <script src="vendor/xlsx.full.min.js"></script>
</head>

<body>
    <!-- Main Store Container -->
    <div class="store-container">
        <!-- Top Stats / Links Row (Inside Container based on screenshot look, or just above?) 
             Screenshot shows "Feedback Support" just above the tabs or in the header. 
             Actually it looks like it's in the white header bar on the right.
        -->
        <header class="store-header">
            <div class="header-left">
                <img src="logo.png" alt="Logo" class="store-logo">
                <div class="header-text">
                    <h2 id="college-name-display">College Name</h2>
                    <p id="store-sub-header">Document Store ERP | Welcome, User</p>
                    <p id="user-email-display" style="font-size: 0.75rem; color: #777; margin: 0;"></p>
                </div>
            </div>

            <div class="header-right" style="display: flex; flex-direction: column; align-items: flex-end; gap: 5px;">
                <div class="top-links" style="font-size: 0.95rem; font-weight: 600;">
                    <a href="feedback.html" id="link-feedback"
                        style="text-decoration: none; color: inherit; margin-right: 15px;">Feedback</a>
                    <a href="support.html" id="link-support" style="text-decoration: none; color: inherit;">Support</a>
                </div>
                <div class="header-actions" style="margin-top: 5px;">
                    <button id="btn-theme-toggle" class="icon-btn" title="Toggle Dark Mode">üåô</button>
                    <button id="btn-settings" class="icon-btn" title="Settings">‚öôÔ∏è</button>
                    <button id="btn-logout" class="icon-btn" title="Logout">‚Ü™Ô∏è</button>
                </div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="write">Write</button>
            <button class="tab-btn" data-tab="store">Store</button>
        </div>

        <!-- Write Section (Default Active) -->
        <div id="write-section" class="content-section active">
            <div style="padding: 1rem 0;">
                <h3 style="margin: 0; font-size: 1.1rem;">Your Notes</h3>
                <p style="margin: 5px 0 0 0; font-size: 0.85rem;">Write anything here. Auto-saved.</p>
            </div>

            <div class="rich-text-toolbar">
                <!-- Toolbar items matches previous but ensuring yellow highlights -->
                <button class="btn-toolbar" onclick="formatText('bold')" title="Bold"
                    style="font-weight: bold;">B</button>
                <button class="btn-toolbar" onclick="formatText('italic')" title="Italic"
                    style="font-style: italic;">I</button>
                <button class="btn-toolbar" onclick="formatText('underline')" title="Underline"
                    style="text-decoration: underline;">U</button>
                <div style="width: 1px; height: 20px; background: #ccc; margin: 0 10px;"></div>
                <button class="btn-toolbar" onclick="formatText('insertUnorderedList')" title="Bullet List">‚Ä¢</button>
                <button class="btn-toolbar" onclick="formatText('insertOrderedList')" title="Numbered List">1.</button>
                <div style="width: 1px; height: 20px; background: #ccc; margin: 0 10px;"></div>
                <button class="btn-toolbar" onclick="formatText('justifyLeft')" title="Align Left">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                        <path d="M3 15h18v-2H3v2zm0 4h12v-2H3v2zm0-8h18V9H3v2zm0-6v2h18V5H3z" />
                    </svg>
                </button>
                <button class="btn-toolbar" onclick="formatText('justifyCenter')" title="Align Center">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                        <path d="M7 15h10v-2H7v2zM3 5v2h18V5H3zm0 8h18V9H3v2zm4 8h10v-2H7v2z" />
                    </svg>
                </button>
                <button class="btn-toolbar" onclick="formatText('justifyRight')" title="Align Right">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                        <path d="M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V9H9v2zm-6-4h18V5H3v2z" />
                    </svg>
                </button>


                <button class="btn-toolbar" onclick="changeFontSize(1, this)" title="Increase Font">A‚ñ≤</button>
                <button class="btn-toolbar" onclick="changeFontSize(-1, this)" title="Decrease Font">A‚ñº</button>
                <select id="font-size-select" onchange="formatText('fontSize', this.value)" title="Font Size"
                    style="height: 32px; padding: 0 5px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; margin: 0 5px;">
                    <option value="1">10</option>
                    <option value="2">13</option>
                    <option value="3" selected>16</option>
                    <option value="4">18</option>
                    <option value="5">24</option>
                    <option value="6">32</option>
                    <option value="7">48</option>
                </select>
                <div style="width: 1px; height: 20px; background: #ccc; margin: 0 10px;"></div>
                <button class="btn-toolbar" onclick="insertTable(this)" title="Insert Excel Table">
                    <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                        <path
                            d="M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 20H4v-4h4v4zm0-6H4v-4h4v4zm0-6H4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4z" />
                    </svg>
                </button>
                <div style="width: 1px; height: 20px; background: #ccc; margin: 0 10px;"></div>
                <button id="btn-color-picker" class="btn-toolbar" onclick="openColorPicker(this)" title="Text Color"
                    style="position: relative; padding: 5px; flex-direction: column; justify-content: center;">
                    <span style="font-size: 1.4rem; line-height: 1; pointer-events: none;">üé®</span>
                    <!-- Active Color Indicator -->
                    <div id="active-color-indicator"
                        style="width: 80%; height: 4px; background-color: #000; margin-top: 2px; border-radius: 2px; pointer-events: none;">
                    </div>
                </button>

                <span id="save-msg" class="save-status" style="margin-left: auto; font-size: 0.8rem;">Saved...</span>
            </div>

            <div id="note-area" class="rich-text-area" contenteditable="true"
                style="min-height: 300px; border-radius: 4px; border: 1px solid #ddd; padding: 15px;">
                <!-- Content goes here -->
            </div>

            <!-- Bottom Export Bar -->
            <div class="export-bar"
                style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; justify-content: flex-end;">
                <button class="btn secondary btn-pill" onclick="saveNoteToPDF()">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="#e74c3c"
                        style="margin-right: 8px; vertical-align: middle;">
                        <path
                            d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3.5H19v1h1.5V10H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z" />
                    </svg>PDF
                </button>
                <button class="btn secondary btn-pill" onclick="saveNoteToWord()">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="#2980b9"
                        style="margin-right: 8px; vertical-align: middle;">
                        <path
                            d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                    </svg>Word
                </button>
                <button class="btn secondary btn-pill" onclick="saveNoteToExcel()">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="#27ae60"
                        style="margin-right: 8px; vertical-align: middle;">
                        <path
                            d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                        <path d="M8 12h8v2H8zm0 4h8v2H8z" opacity=".3" />
                    </svg>Excel
                </button>
                <button class="btn secondary btn-pill" onclick="saveNoteToStore()">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="#34495e"
                        style="margin-right: 8px; vertical-align: middle;">
                        <path
                            d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z" />
                    </svg>Save into Store
                </button>
                <button class="btn secondary btn-folder-yellow btn-pill" onclick="saveNoteToFolder()">
                    <svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"
                        style="margin-right: 8px; vertical-align: middle;">
                        <path
                            d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z" />
                    </svg>Save to Folder...
                </button>
            </div>
        </div>

        <!-- Store Section -->
        <div id="store-section" class="content-section">
            <div style="margin-bottom: 1rem;">
                <h3 style="margin: 0; color: #444;">Document Storage</h3>
                <p style="margin: 5px 0 0 0; color: #888; font-size: 0.85rem;">Store PDF, PPT, Excel, Text files</p>
            </div>

            <div class="files-toolbar"
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; border-bottom: 1px dashed #ddd; padding-bottom: 10px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <button id="btn-back" class="btn secondary"
                        style="display:none; padding: 5px 10px; font-size: 0.9rem;">&larr;</button>
                    <span id="breadcrumbs" style="font-weight: 600; color: #555;">Home</span>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="file-search" class="input-field" placeholder="Search files..."
                        style="padding: 8px; width: 200px; height: 35px;">
                    <button id="btn-create-folder" class="btn primary" style="padding: 8px 15px; height: 35px;">+ New
                        Folder</button>
                    <button id="btn-view-toggle" class="icon-btn" title="Toggle View"
                        style="height: 35px; width: 35px; display: flex; align-items: center; justify-content: center;">
                        <span id="icon-grid" style="display: none;">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path
                                    d="M4 11h5V5H4v6zm0 7h5v-6H4v6zm6 0h5v-6h-5v6zm6 0h5v-6h-5v6zm-6-7h5V5h-5v6zm6-6v6h5V5h-5z" />
                            </svg>
                        </span>
                        <span id="icon-list">
                            <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                                <path
                                    d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z" />
                            </svg>
                        </span>
                    </button>
                </div>
            </div>

            <div id="drop-zone" class="drop-zone" style="padding: 2rem; border-style: dashed;">
                <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                    <svg viewBox="0 0 24 24" width="48" height="48" fill="#ffd700">
                        <path
                            d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM14 13v4h-4v-4H7l5-5 5 5h-3z" />
                    </svg>
                    <span class="drag-highlight">Click to Upload or Drag Files</span>
                </div>
                <input type="file" id="file-input" multiple hidden>
            </div>

            <div id="file-list-display" class="file-list">
                <!-- Files populate here -->
            </div>
        </div>

    </div>

    <!-- Color Picker Modal -->
    <div id="color-picker-modal" class="modal-overlay">
        <div class="modal-box" style="width: 340px; padding: 25px; border-radius: 12px;">
            <h3 style="margin-top:0; margin-bottom: 20px; font-weight:600; color:#333; text-align: left;">Text Color
            </h3>

            <!-- Standard Colors -->
            <div style="text-align:left; margin-bottom: 10px; font-size: 0.85rem; color: #666; font-weight: 500;">
                PRESETS</div>
            <div class="color-grid"
                style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 25px;">
                <button class="color-swatch" style="background: #000000;" onclick="selectColor('#000000')"
                    title="Black"></button>
                <button class="color-swatch" style="background: #434343;" onclick="selectColor('#434343')"
                    title="Dark Grey"></button>
                <button class="color-swatch" style="background: #666666;" onclick="selectColor('#666666')"
                    title="Grey"></button>
                <button class="color-swatch" style="background: #999999;" onclick="selectColor('#999999')"
                    title="Light Grey"></button>
                <button class="color-swatch" style="background: #b7b7b7;" onclick="selectColor('#b7b7b7')"
                    title="Silver"></button>

                <button class="color-swatch" style="background: #d90000;" onclick="selectColor('#d90000')"
                    title="Red"></button>
                <button class="color-swatch" style="background: #f4c400;" onclick="selectColor('#f4c400')"
                    title="Yellow"></button>
                <button class="color-swatch" style="background: #008a00;" onclick="selectColor('#008a00')"
                    title="Green"></button>
                <button class="color-swatch" style="background: #00bdf4;" onclick="selectColor('#00bdf4')"
                    title="Cyan"></button>
                <button class="color-swatch" style="background: #0000ff;" onclick="selectColor('#0000ff')"
                    title="Blue"></button>
            </div>

            <div style="height: 1px; background: #eee; margin-bottom: 20px;"></div>

            <!-- Custom Section -->
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 25px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <div
                        style="position: relative; width: 36px; height: 36px; border-radius: 50%; overflow: hidden; border: 2px solid #ddd; cursor: pointer; transition: transform 0.2s;">
                        <input type="color" id="custom-color-input"
                            style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; cursor: pointer; border: none; padding: 0;"
                            oninput="selectColor(this.value)">
                    </div>
                    <div style="text-align: left;">
                        <div class="custom-label">Custom</div>
                        <div class="custom-sublabel">Pick a color</div>
                    </div>
                </div>

                <!-- Preview Box -->
                <div style="text-align: right;">
                    <div style="font-size: 0.8rem; color: #888; margin-bottom: 4px;">Selected</div>
                    <div id="chosen-color-preview"
                        style="width: 40px; height: 40px; border-radius: 8px; border: 1px solid #ddd; background: #000; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                    </div>
                </div>
            </div>

            <div class="button-group" style="justify-content: flex-end; gap: 10px;">
                <button class="btn secondary" style="border: 1px solid #ddd; padding: 10px 20px;"
                    onclick="closeColorPicker()">Cancel</button>
                <button class="btn primary"
                    style="background: var(--primary-orange); border: none; padding: 10px 25px; font-weight: 600;"
                    onclick="applySelectedColor()">Apply</button>
            </div>
        </div>
    </div>

    <!-- Shared Modal -->
    <div id="custom-modal" class="modal-overlay">
        <div class="modal-box">
            <h3 id="modal-title">Notification</h3>
            <p id="modal-message"></p>
            <input type="text" id="modal-input" class="input-field" style="display:none; margin: 10px 0;">
            <select id="modal-select" class="input-field" style="display:none; margin: 10px 0; padding: 10px;"></select>
            <div id="modal-actions" class="button-group" style="justify-content: center; margin-top: 1rem;">
                <button class="btn primary" onclick="closeModal()">OK</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="modal-overlay">
        <div class="modal-box" style="width: 400px; text-align: left;">
            <h3 style="border-bottom: 2px solid #eee; padding-bottom: 10px; margin-bottom: 15px;">Settings</h3>

            <div class="setting-item"
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <label>Dark Mode</label>
                <input type="checkbox" id="setting-dark-mode-toggle" style="transform: scale(1.5);">
            </div>

            <div class="setting-item"
                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <label>Default Font Size</label>
                <select id="setting-font-size" style="padding: 5px;">
                    <option value="1">Small</option>
                    <option value="3" selected>Normal</option>
                    <option value="5">Large</option>
                </select>
            </div>

            <div style="text-align: right; margin-top: 20px;">
                <button class="btn secondary"
                    onclick="document.getElementById('settings-modal').classList.remove('active')">Close</button>
            </div>
        </div>
    </div>



    <!-- Document Preview Modal -->
    <div id="preview-modal" class="preview-overlay" style="display: none;">
        <div class="preview-container">
            <header class="preview-header">
                <span id="preview-filename">Document Preview</span>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <a id="preview-download-btn" class="btn-action" title="Download"
                        style="display: none; text-decoration: none; color: white; background: rgba(255,255,255,0.1); width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 0.9rem;">‚¨áÔ∏è</a>
                    <button onclick="closePreview()" class="btn-close-preview">‚úï</button>
                </div>
            </header>
            <div id="preview-content" class="preview-body">
                <div class="preview-loading">Loading...</div>
            </div>
        </div>
    </div>

    <script type="module" src="firebase-init.js"></script>
    <script src="script.js?v=10.0"></script>
</body>

</html>